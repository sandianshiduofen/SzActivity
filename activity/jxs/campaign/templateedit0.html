<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no"><title>活动模板添加1</title><link rel="stylesheet" href="./css/main.css"><script src="./js/jquery-1.11.3.min.js"></script><script src="./js/alert.js"></script><script src="./js/enjoyhint/enjoyhint.min.js"></script><link rel="stylesheet" href="./js/enjoyhint/enjoyhint.css"><script src="../../common/js/source/vue.min.js"></script><script src="./js/main.js"></script></head><body><style></style><section class="act_wraper" id="temBox"><div class="act_name_input"><span>活动名称:</span> <input class="actName" type="text" placeholder="" v-model="goods.title"><p><span id="name_input_num">0</span>/20</p></div><ul class="goods_list"><li v-for="(list,index) in goods.list" class="goods_recommend" :data-num="index"><div class="goods_recommend_l"><form class="imgFile"><label><img :src="list.goodsImg?list.goodsImg:'images/banner.jpg'"> <input class="recommend_img" type="file" @change="changeImg(index,event)" name="file" accept="image/*"><div v-show="!list.goodsImgInput" class="shade_lucency"><p>商品名字<span>上传一张图片</span></p></div></label></form></div><div class="goods_recommend_r" @click="editGoods(index)"><p>{{list.goodsName?list.goodsName:"无线充电器"}}</p><p>{{list.goodsDescribe?list.goodsDescribe:"买一送二超级实惠"}}</p><p>{{list.goodsOldPrice?list.goodsOldPrice:150}}</p><p>{{list.goodsNewPrice?list.goodsNewPrice:100}}</p><div v-show="!list.goodsInput" class="shade_lucency"><p>商品名字<span>点击填写</span></p></div></div><div class="goods_del" @click="delGoods(index)"><img src="images/close.png"></div></li></ul><button @click="addGoods">添加</button><div v-show="edit.goodsShow" class="fillout_goods" :data-num="edit.goodsNumEdit"><div><span>商品名称：</span> <input type="text" v-model="edit.goodsNameEdit"></div><div><span>商品描述：</span> <input type="text" v-model="edit.goodsDescribeEdit"></div><div><span>原价：</span> <input type="text" v-model="edit.goodsOldPriceEdit"></div><div><span>活动价：</span> <input type="text" v-model="edit.goodsNewPriceEdit"></div><button @click="trueGoods">确定</button></div><div class="goods_footer_wraper"><div class="goods_footer"><p class="preview" @click="preview"><span><img src="./images/eye.png"></span>&nbsp;&nbsp;预览效果</p><p class="next" onclick="history.back()">上一步</p></div></div></section><script>var app=new Vue({el:"#temBox",data:{goods:{title:"",list:[{goodsName:"",goodsImg:"",goodsDescribe:"",goodsOldPrice:"",goodsNewPrice:"",goodsInput:"",goodsImgInput:""}]},edit:{goodsShow:!1,goodsNumEdit:"",goodsNameEdit:"",goodsDescribeEdit:"",goodsOldPriceEdit:"",goodsNewPriceEdit:""}},methods:{addGoods:function(){if(this.goods.list.length<=10){this.goods.list.push({goodsName:"",goodsImg:"",goodsDescribe:"",goodsOldPrice:"",goodsNewPrice:"",goodsInput:""})}else alert("最多只能添加10个商品")},editGoods:function(o){this.edit.goodsShow=!0;var s=this.goods.list[o];s.goodsInput?(this.edit.goodsNumEdit=o,this.edit.goodsNameEdit=s.goodsName,this.edit.goodsDescribeEdit=s.goodsDescribe,this.edit.goodsOldPriceEdit=s.goodsOldPrice,this.edit.goodsNewPriceEdit=s.goodsNewPrice):(this.edit.goodsNumEdit=o,this.edit.goodsNameEdit="",this.edit.goodsDescribeEdit="",this.edit.goodsOldPriceEdit="",this.edit.goodsNewPriceEdit="")},changeImg:function(d,o){o.target.value;var s=new FormData(o.target.parentNode.parentNode);s.append("type",3),s.append("path","headImg"),s.append("requestTokenId",variateObj.requestTokenId());var e=this;$.ajax({url:"http://tmsimg.3zqp.com/api/tms/pc/upload",type:"POST",data:s,cache:!1,contentType:!1,processData:!1,success:function(o){var s=o.info.domain,t=o.info.filePath,i=e.goods.list[d];i.goodsImg=s+""+t,i.goodsImgInput=1},complete:function(o,s){console.log(o),"error"!=s&&"timeout"!=s||alert("图片上传失败")}})},trueGoods:function(){var o=this.edit.goodsNumEdit,s=this.goods.list[o];s.goodsName=this.edit.goodsNameEdit,s.goodsDescribe=this.edit.goodsDescribeEdit,s.goodsOldPrice=this.edit.goodsOldPriceEdit,s.goodsNewPrice=this.edit.goodsNewPriceEdit,s.goodsInput=1,this.edit.goodsShow=!1,this.edit.goodsNumEdit="",this.edit.goodsNameEdit="",this.edit.goodsDescribeEdit="",this.edit.goodsOldPriceEdit="",this.edit.goodsNewPriceEdit=""},delGoods:function(o){1<this.goods.list.length&&this.goods.list.splice(o,1)},preview:function(){console.log(JSON.parse(JSON.stringify(this.goods)))},next:function(){this.setInfo("goodList",JSON.stringify(this.goods));var o=window.sessionStorage;console.log(o.goodList)},setInfo:function(o,s){window.sessionStorage.setItem(o,s)},show:function(){console.log("storage.goodList");var o=window.sessionStorage;console.log(o.goodList),this.goods=JSON.parse(o.goodList)}},created:function(){this.show()}})</script></body></html>