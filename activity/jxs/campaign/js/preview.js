var app=new Vue({el:"#temBox",data:{goods:{name:"",content:{describe:"",list:[]},createTime:"",company:"",viewPv:0},edit:{showRedPacket:!1,redPacketNum:!1,companyName:"",haveRedPacket:!1,NoRedPacket:!1,overRedPacket:!1,chatTel:!1,isDisable:!1}},created:function(){szad.init();var id=packaging.GetQueryString("id");if(id)this.show(id),packaging.GetQueryString("garageId")&&(this.edit.chatTel=!0,this.statistics(id),this.redPacket(id));else{var storage=window.sessionStorage;if(storage.goodList){var that=this;szad.getUserInfo(function(userInfo){userInfo=actCommon.transformJson(userInfo);that.goods=JSON.parse(storage.goodList),that.goods.viewPv=0,that.goods.createTime="刚刚",that.goods.company=userInfo.company})}}},methods:{show:function(id){packaging.loading("加载中...");var selectJson={advertiseId:parseInt(id)},url=actCommon.appApi()+"/api/app/advertise/garage/ad/detail",that=this;szad.requestNetworkData(url,selectJson,function(data){packaging.loadingRemove(),(data=actCommon.transformJson(data)).success?(that.goods.viewPv=data.info.pv,that.goods.name=data.info.advertiseName,that.goods.company=data.info.company,that.goods.content=JSON.parse(data.info.content),that.goods.createTime=that.timeCycle(data.info.startTime,data.info.endTime),packaging.GetQueryString("garageId")&&incident.userInfo(id,data.info.userId)):packaging.fubottom(data.message)})},statistics:function(id){var selectJson={account:packaging.GetQueryString("account"),advertiseId:parseInt(id)},url=actCommon.appApiN()+"/api/app/advertise/garage/ad/browse/count";szad.requestNetworkData(url,selectJson,function(data){(data=actCommon.transformJson(data)).success||packaging.fubottom(data.message)})},redPacket:function(id){var selectJson={account:packaging.GetQueryString("account"),advertiseId:parseInt(id)},url=actCommon.appApiG()+"/api/app/advertise/garage/check/red/envelope",that=this;szad.requestNetworkData(url,selectJson,function(data){(data=actCommon.transformJson(data)).success&&(that.edit.showRedPacket=!0,window.actCommon.downHint())})},getRedPacket:function(){this.edit.isDisable=!0,setTimeout(function(){that.edit.isDisable=!1},2e3);var that=this;document.getElementById("lingqu").classList.add("shake-chunk");var selectJson={account:packaging.GetQueryString("account"),advertiseId:parseInt(packaging.GetQueryString("id")),userId:packaging.GetQueryString("garageId")},url=actCommon.appApiG()+"/api/app/advertise/garage/open/red/envelope";szad.requestNetworkData(url,selectJson,function(data){(data=actCommon.transformJson(data)).success?(that.edit.showRedPacket=!1,9==parseInt(data.info.result)?(that.edit.haveRedPacket=!0,that.edit.redPacketNum=data.info.noteNum,that.edit.companyName=data.info.company):0==parseInt(data.info.result)?that.edit.NoRedPacket=!0:1==parseInt(data.info.result)?that.edit.overRedPacket=!0:that.edit.NoRedPacket=!0):packaging.fubottom(data.message)})},timeCycle:function(stardTime,endTime){stardTime=parseInt(stardTime);var currentTime=new Date,time=(currentTime=parseInt(currentTime/1e3))-(stardTime=parseInt(stardTime/1e3));if(currentTime<stardTime)return"活动未开始";if(endTime<currentTime)return"活动已结束";var min=parseInt(time/60);if(min<60)return min+"分钟前";var hours=parseInt(time/3600);if(hours<24)return hours+"小时前";var days=parseInt(time/3600/24);if(days<30)return days+"天前";var months=parseInt(time/3600/24/30);return months<12?months+"月前":parseInt(time/3600/24/30/12)+"年前"},huanhang:function(value){if(!value)return"";for(var strArr=(value=value.toString()).split("\n"),str="",i=0;i<strArr.length;i++)str+="<p>"+strArr[i]+"</p>";return str},iKnowClose:function(){return this.edit.haveRedPacket?this.edit.haveRedPacket=!1:this.edit.showRedPacket?this.edit.showRedPacket=!1:this.edit.NoRedPacket?this.edit.NoRedPacket=!1:this.edit.overRedPacket?this.edit.overRedPacket=!1:void 0},addspan:function(text){var price=parseFloat(text).toFixed(2).split(".");return'<b style="font-weight:normal">'+price[0]+"</b>."+price[1]}}});